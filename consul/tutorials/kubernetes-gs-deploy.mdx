---
id: e94716fd-cd25-45c3-8d9b-c00ec67b7f93
name: Deploy Consul on Kubernetes
description: >-
  Deploy Consul on Kubernetes to explore Consul's core features and
  functionality.
products_used:
  - product: consul
    min_version: 1.14.4
read_time: 10
default_collection_context: consul/get-started-kubernetes
---

Consul is a service networking solution that enables teams to manage secure network connectivity between services and across on-prem and multi-cloud environments and runtimes. 
Consul offers service discovery, service mesh, traffic management, and automated updates to network infrastructure devices. 
out the [What is Consul?](/consul/docs/introoo) page to learn more.

In this tutorial, you will deploy a Consul datacenter onto a Kubernetes cluster. After deploying Consul, you will interact with Consul using the UI and CLI.

In the following tutorials, you will deploy a demo application, integrate it with Consul service mesh, allow external traffic into the service mesh, and enhance observability into your service mesh.

Select your learning path by clicking one of the following tabs.

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

In this tutorial, you will:

- Deploy a HashiCorp Cloud Platform (HCP) Consul datacenter and an Elastic Kubernetes Service (EKS) cluster with Terraform
- Configure your terminal to communicate with the Consul datacenter
- View Consul services with the CLI, UI, and/or API

</Tab>
<Tab heading="AKS" group="hcp-aks">

In this tutorial, you will:

- Deploy a HashiCorp Cloud Platform (HCP) Consul datacenter and an Azure Kubernetes Service (AKS) cluster with Terraform
- Configure your terminal to communicate with the Consul datacenter
- View Consul services with the CLI, UI, and/or API

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

In this tutorial, you will:

- Deploy an Elastic Kubernetes Service (EKS) cluster with Terraform
- Install Consul using Helm or the Consul K8S CLI
- Configure your terminal to communicate with the Consul datacenter
- View Consul services with the CLI, UI, and/or API

</Tab>
<Tab heading="AKS" group="self-aks">

In this tutorial, you will:

- Deploy an Azure Kubernetes Service (AKS) cluster with Terraform
- Install Consul using Helm or the Consul K8S CLI
- Configure your terminal to communicate with the Consul datacenter
- View Consul services with the CLI, UI, and/or API

</Tab>
<Tab heading="Local" group="self-local">

In this tutorial, you will:

- Create a local Kubernetes cluster using `kind`
- Install Consul using Helm or the Consul K8S CLI
- Configure your terminal to communicate with the Consul datacenter
- View Consul services with the CLI, UI, and/or API

</Tab>

</Tabs>
</Tab>
</Tabs>

## Prerequisites

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

For this tutorial, you will need:

- An [AWS account](https://aws.amazon.com/account/) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#authentication-and-configuration)
- An [HCP account](https://portal.cloud.hashicorp.com/sign-in?utm_source=learn) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/hcp/latest/docs/guides/auth)
- [aws-cli >= 2.0](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html)
- [terraform >= 1.0](/terraform/tutorials/aws-get-started/install-cli)
- [consul >= 1.14.4](/consul/downloads/)
- [consul-k8s >= 1.0.0](/consul/docs/k8s/installation/install-cli) 
- [git >= 2.0](https://git-scm.com/downloads)
- [helm >= 3.0](https://helm.sh/docs/using_helm/)
- [kubectl <= 1.24](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

</Tab>
<Tab heading="AKS" group="hcp-aks">

For this tutorial, you will need:

- An [Azure account](http://portal.azure.com) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/guides/azure_cli)
- An [HCP account](https://portal.cloud.hashicorp.com/sign-in?utm_source=learn) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/hcp/latest/docs/guides/auth)
- [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli)
- [terraform >= 1.0](/terraform/tutorials/aws-get-started/install-cli)
- [consul >= 1.14.4](/consul/downloads/)
- [consul-k8s >= 1.0.0](/consul/docs/k8s/installation/install-cli) 
- [git >= 2.0](https://git-scm.com/downloads)
- [helm >= 3.0](https://helm.sh/docs/using_helm/)
- [kubectl <= 1.24](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

For this tutorial, you will need:

- An [AWS account](https://aws.amazon.com/account/) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#authentication-and-configuration)
- [aws-cli >= 2.0](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html)
- [terraform >= 1.0](/terraform/tutorials/aws-get-started/install-cli)
- [consul >= 1.14.4](/consul/downloads/)
- [consul-k8s >= 1.0.0](/consul/docs/k8s/installation/install-cli) 
- [git >= 2.0](https://git-scm.com/downloads)
- [helm >= 3.0](https://helm.sh/docs/using_helm/)
- [kubectl <= 1.24](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

</Tab>
<Tab heading="AKS" group="self-aks">

For this tutorial, you will need:

- An [Azure account](http://portal.azure.com) configured for [use with Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/guides/azure_cli)
- [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli)
- [terraform >= 1.0](/terraform/tutorials/aws-get-started/install-cli)
- [consul >= 1.14.4](/consul/downloads/)
- [consul-k8s >= 1.0.0](/consul/docs/k8s/installation/install-cli) 
- [git >= 2.0](https://git-scm.com/downloads)
- [helm >= 3.0](https://helm.sh/docs/using_helm/)
- [kubectl <= 1.24](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

</Tab>
<Tab heading="Local" group="self-local">

For this tutorial, you will need:

- [consul >= 1.14.4](/consul/downloads/)
- [consul-k8s >= 1.0.0](/consul/docs/k8s/installation/install-cli) 
- [docker >= 20.0](https://docs.docker.com/get-docker/)
- [git >= 2.0](https://git-scm.com/downloads)
- [helm >= 3.0](https://helm.sh/docs/using_helm/)
- [kind <= 0.24.x](https://kind.sigs.k8s.io/docs/user/quick-start/)
- [kubectl <= 1.24](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

</Tab>

</Tabs>
</Tab>
</Tabs>

## Clone GitHub repository

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

Clone the [GitHub repository](https://github.com/hashicorp-education/learn-consul-get-started-kubernetes) containing the configuration files and resources.

<CodeTabs tabs={[ "HTTPS", "SSH" ]}>

```shell-session
$ git clone https://github.com/hashicorp-education/learn-consul-get-started-kubernetes.git
```

```shell-session
$ git clone git@github.com:hashicorp-education/learn-consul-get-started-kubernetes.git
```

</CodeTabs>

Change into the directory that contains the complete configuration files for this tutorial.

```shell-session
$ cd learn-consul-get-started-kubernetes/hcp-managed/eks
```

</Tab>
<Tab heading="AKS" group="hcp-aks">

Clone the [GitHub repository](https://github.com/hashicorp-education/learn-consul-get-started-kubernetes) containing the configuration files and resources.

<CodeTabs tabs={[ "HTTPS", "SSH" ]}>

```shell-session
$ git clone https://github.com/hashicorp-education/learn-consul-get-started-kubernetes.git
```

```shell-session
$ git clone git@github.com:hashicorp-education/learn-consul-get-started-kubernetes.git
```

</CodeTabs>

Change into the directory that contains the complete configuration files for this tutorial.

```shell-session
$ cd learn-consul-get-started-kubernetes/hcp-managed/aks
```

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

Clone the [GitHub repository](https://github.com/hashicorp-education/learn-consul-get-started-kubernetes) containing the configuration files and resources.

<CodeTabs tabs={[ "HTTPS", "SSH" ]}>

```shell-session
$ git clone https://github.com/hashicorp-education/learn-consul-get-started-kubernetes.git
```

```shell-session
$ git clone git@github.com:hashicorp-education/learn-consul-get-started-kubernetes.git
```

</CodeTabs>

Change into the directory that contains the complete configuration files for this tutorial.

```shell-session
$ cd learn-consul-get-started-kubernetes/self-managed/eks
```

</Tab>
<Tab heading="AKS" group="self-aks">

Clone the [GitHub repository](https://github.com/hashicorp-education/learn-consul-get-started-kubernetes) containing the configuration files and resources.

<CodeTabs tabs={[ "HTTPS", "SSH" ]}>

```shell-session
$ git clone https://github.com/hashicorp-education/learn-consul-get-started-kubernetes.git
```

```shell-session
$ git clone git@github.com:hashicorp-education/learn-consul-get-started-kubernetes.git
```

</CodeTabs>

Change into the directory that contains the complete configuration files for this tutorial.

```shell-session
$ cd learn-consul-get-started-kubernetes/self-managed/aks
```

</Tab>
<Tab heading="Local" group="self-local">

Clone the [GitHub repository](https://github.com/hashicorp-education/learn-consul-get-started-kubernetes) containing the configuration files and resources.

<CodeTabs tabs={[ "HTTPS", "SSH" ]}>

```shell-session
$ git clone https://github.com/hashicorp-education/learn-consul-get-started-kubernetes.git
```

```shell-session
$ git clone git@github.com:hashicorp-education/learn-consul-get-started-kubernetes.git
```

</CodeTabs>

Change into the directory that contains the complete configuration files for this tutorial.

```shell-session
$ cd learn-consul-get-started-kubernetes/self-managed/local
```

</Tab>

</Tabs>
</Tab>
</Tabs>

## Create infrastructure

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

With these Terraform configuration files, you are ready to deploy your infrastructure.

Issue the `terraform init` command from your working directory to download the necessary providers and initialize the backend.

```shell-session
$ terraform init

Initializing the backend...

Initializing provider plugins...
...

Terraform has been successfully initialized!
...
```

Then, deploy the resources. Confirm the run by entering `yes`.

```shell-session
$ terraform apply

## ...
Do you want to perform these actions?
 Terraform will perform the actions described above.
 Only 'yes' will be accepted to approve.

 Enter a value: yes

## ...

Apply complete! Resources: 68 added, 0 changed, 0 destroyed.
```

-> **Note:** The Terraform deployment could take up to 15 minutes to complete. Feel free to explore the next sections of this tutorial while waiting for the environment to complete initialization or learn more about the [Raft protocol](http://thesecretlivesofdata.com/raft/) in a fun, interactive way.

</Tab>
<Tab heading="AKS" group="hcp-aks">

With these Terraform configuration files, you are ready to deploy your infrastructure.

Issue the `terraform init` command from your working directory to download the necessary providers and initialize the backend.

```shell-session
$ terraform init

Initializing the backend...

Initializing provider plugins...
...

Terraform has been successfully initialized!
...
```

Then, deploy the resources. Confirm the run by entering `yes`.

```shell-session
$ terraform apply

## ...
Do you want to perform these actions?
 Terraform will perform the actions described above.
 Only 'yes' will be accepted to approve.

 Enter a value: yes

## ...

Apply complete! Resources: 24 added, 0 changed, 0 destroyed.
```

-> **Note:** The Terraform deployment could take up to 15 minutes to complete. Feel free to explore the next sections of this tutorial while waiting for the environment to complete initialization or learn more about the [Raft protocol](http://thesecretlivesofdata.com/raft/) in a fun, interactive way.

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

With these Terraform configuration files, you are ready to deploy your infrastructure.

Issue the `terraform init` command from your working directory to download the necessary providers and initialize the backend.

```shell-session
$ terraform init

Initializing the backend...

Initializing provider plugins...
...

Terraform has been successfully initialized!
...
```

Then, deploy the resources. Confirm the run by entering `yes`.

```shell-session
$ terraform apply

## ...
Do you want to perform these actions?
 Terraform will perform the actions described above.
 Only 'yes' will be accepted to approve.

 Enter a value: yes

## ...

Apply complete! Resources: 54 added, 0 changed, 0 destroyed.
```

-> **Note:** The Terraform deployment could take up to 10 minutes to complete. Feel free to explore the next sections of this tutorial while waiting for the environment to complete initialization or learn more about the [Raft protocol](http://thesecretlivesofdata.com/raft/) in a fun, interactive way.

</Tab>
<Tab heading="AKS" group="self-aks">

With these Terraform configuration files, you are ready to deploy your infrastructure.

Issue the `terraform init` command from your working directory to download the necessary providers and initialize the backend.

```shell-session
$ terraform init

Initializing the backend...

Initializing provider plugins...
...

Terraform has been successfully initialized!
...
```

Then, deploy the resources. Confirm the run by entering `yes`.

```shell-session
$ terraform apply

## ...
Do you want to perform these actions?
 Terraform will perform the actions described above.
 Only 'yes' will be accepted to approve.

 Enter a value: yes

## ...

Apply complete! Resources: 17 added, 0 changed, 0 destroyed.
```

-> **Note:** The Terraform deployment could take up to 10 minutes to complete. Feel free to explore the next sections of this tutorial while waiting for the environment to complete initialization or learn more about the [Raft protocol](http://thesecretlivesofdata.com/raft/) in a fun, interactive way.

</Tab>
<Tab heading="Local" group="self-local">

## Create Kubernetes cluster

In this section, you will create a Kubernetes cluster with `kind` that provides an environment for you to explore Consul service mesh functionality.

Create a new cluster with `kind`.

```shell-session
$ kind create cluster --config=kind/cluster.yaml
Creating cluster "kind" ...
✓ Ensuring node image (kindest/node:v1.24.0) 🖼
✓ Preparing nodes 📦
✓ Writing configuration 📜
✓ Starting control-plane 🕹️
✓ Installing CNI 🔌
✓ Installing StorageClass 💾
Set kubectl context to "kind-kind"
You can now use your cluster with:

kubectl cluster-info --context kind-kind

Have a nice day! 👋
```

</Tab>

</Tabs>
</Tab>
</Tabs>

## Connect to your infrastructure

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

Kubernetes stores cluster connection information in a file called `kubeconfig`. You can retrieve the Kubernetes configuration settings for your EKS cluster and merge them into your local `kubeconfig` file by issuing the following command:

```shell-session
$ aws eks --region $(terraform output -raw region) update-kubeconfig --name $(terraform output -raw kubernetes_cluster_id)
```

</Tab>
<Tab heading="AKS" group="hcp-aks">

Kubernetes stores cluster connection information in a file called `kubeconfig`. You can retrieve the Kubernetes configuration settings for your EKS cluster and merge them into your local `kubeconfig` file by issuing the following command:

```shell-session
$ az aks get-credentials --resource-group $(terraform output -raw azure_rg_name) --name $(terraform output -raw aks_cluster_name)
```

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

Kubernetes stores cluster connection information in a file called `kubeconfig`. You can retrieve the Kubernetes configuration settings for your EKS cluster and merge them into your local `kubeconfig` file by issuing the following command:

```shell-session
$ aws eks --region $(terraform output -raw region) update-kubeconfig --name $(terraform output -raw kubernetes_cluster_id)
```

</Tab>
<Tab heading="AKS" group="self-aks">

Kubernetes stores cluster connection information in a file called `kubeconfig`. You can retrieve the Kubernetes configuration settings for your AKS cluster and merge them into your local `kubeconfig` file by issuing the following command:

```shell-session
$ az aks get-credentials --resource-group $(terraform output -raw azure_rg_name) --name $(terraform output -raw aks_cluster_name)
```

</Tab>
<Tab heading="Local" group="self-local">

Kubernetes stores cluster connection information in a file called `kubeconfig`. When you create the `kind` cluster, it automatically updates your `kubectl` context to target the cluster. Verify that your Kubernetes context is set to the `kind` cluster by issuing the following command:

```shell-session
$ kubectl cluster-info --context kind-kind
Kubernetes control plane is running at https://127.0.0.1:54233
CoreDNS is running at https://127.0.0.1:54233/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
```

</Tab>

</Tabs>
</Tab>
</Tabs>

## Deploy Consul datacenter

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

HCP Consul is a secure, fully-managed solution for Consul and can be used immediately after the Terraform deployment completes, with no additional deployment/configuration steps. HCP Consul provides you with [all Consul Enterprise features](/consul/docs/enterprise) by default. Feel free to go directly to [Configure your CLI to interact with Consul datacenter](#configure-your-cli-to-interact-with-consul-datacenter).

</Tab>
<Tab heading="AKS" group="hcp-aks">

HCP Consul is a secure, fully-managed solution for Consul and can be used immediately after the Terraform deployment completes, with no additional deployment/configuration steps. HCP Consul provides you with all [Consul Enterprise features](/consul/docs/enterprise) by default. Feel free to go directly to [Configure your CLI to interact with Consul datacenter](#configure-your-cli-to-interact-with-consul-datacenter).

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

### Review Consul server configuration

You will now review the Helm chart for deploying a Consul datacenter in your Kubernetes cluster using the [`consul-k8s` CLI](/consul/docs/k8s/installation/install-cli) or [Helm](/consul/docs/k8s/installation/install) installation methods. 

To deploy Consul on Kubernetes, go directly to [Deploy Consul](#deploy-consul-datacenter-1).

Review `helm/values-v1.yaml`. This file defines the Consul datacenter you will deploy to Kubernetes. Review the comments in the file for an explanation of each parameter.

<CodeBlockConfig filename="helm/values-v1.yaml" hideClipboard>

```yaml
# Contains values that affect multiple components of the chart.
global:
  # The main enabled/disabled setting.
  # If true, servers, clients, Consul DNS and the Consul UI will be enabled.
  enabled: true
  # The prefix used for all resources created in the Helm chart.
  name: consul
  # The consul image version.
  image: hashicorp/consul:1.14.4
  # The name of the datacenter that the agents should register as.
  datacenter: dc1
  # Enables TLS across the cluster to verify authenticity of the Consul servers and clients.
  tls:
    enabled: true
  # Enables ACLs across the cluster to secure access to data and APIs.
  acls:
    # If true, automatically manage ACL tokens and policies for all Consul components.
    manageSystemACLs: true
# Configures values that configure the Consul server cluster.
server:
  enabled: true
  # The number of server agents to run. This determines the fault tolerance of the cluster.
  replicas: 3
# Contains values that configure the Consul UI.
ui:
  enabled: true
  # Registers a Kubernetes Service for the Consul UI as a LoadBalancer.
  service:
    type: LoadBalancer
# Configures and installs the automatic Consul Connect sidecar injector.
connectInject:
  enabled: true
```

</CodeBlockConfig>

For a complete list of Helm chart parameters and configuration, refer to the [Consul Helm chart](/consul/docs/k8s/helm#configuration-values) documentation.

### Deploy Consul datacenter

Deploy a Consul datacenter to your Kubernetes environment with the Consul K8S CLI or Helm.

<Tabs>
<Tab heading="Consul K8S CLI">

Install Consul to your Kubernetes cluster with the Consul K8S CLI. Confirm the run by entering `y`.

```shell-session
$ consul-k8s install -config-file=helm/values-v1.yaml
## ...
    Proceed with installation? (y/N) y
==> Installing Consul
## ...
✓ Consul installed in namespace "consul".
```

Notice that the Consul K8s CLI installs Consul into the `consul` namespace. 

Refer to the [Consul K8S CLI documentation](/consul/docs/k8s/k8s-cli) to learn more about additional settings.

</Tab>
<Tab heading="Helm">

Add the HashiCorp Helm Chart repository.

```shell-session
$ helm repo add hashicorp https://helm.releases.hashicorp.com
"hashicorp" has been added to your repositories
```

Install Consul to your Kubernetes cluster with the Helm chart. Notice that this command installs Consul into the `consul` namespace. 

```shell-session
$ helm install --values helm/values-v1.yaml consul hashicorp/consul --create-namespace --namespace consul --version "1.0.2"
```

</Tab>
</Tabs>

</Tab>
<Tab heading="AKS" group="self-aks">

### Review Consul server configuration

You will now review the Helm chart for deploying a Consul datacenter in your Kubernetes cluster using the [`consul-k8s` CLI](/consul/docs/k8s/installation/install-cli) or [Helm](/consul/docs/k8s/installation/install) installation methods. 

To deploy Consul on Kubernetes, go directly to [Deploy Consul](#deploy-consul-datacenter-2).

Review `helm/values-v1.yaml`. This file defines the Consul datacenter you will deploy to Kubernetes. Review the comments in the file for an explanation of each parameter.

<CodeBlockConfig filename="helm/values-v1.yaml" hideClipboard>

```yaml
# Contains values that affect multiple components of the chart.
global:
  # The main enabled/disabled setting.
  # If true, servers, clients, Consul DNS and the Consul UI will be enabled.
  enabled: true
  # The prefix used for all resources created in the Helm chart.
  name: consul
  # The consul image version.
  image: hashicorp/consul:1.14.4
  # The name of the datacenter that the agents should register as.
  datacenter: dc1
  # Enables TLS across the cluster to verify authenticity of the Consul servers and clients.
  tls:
    enabled: true
  # Enables ACLs across the cluster to secure access to data and APIs.
  acls:
    # If true, automatically manage ACL tokens and policies for all Consul components.
    manageSystemACLs: true
# Configures values that configure the Consul server cluster.
server:
  enabled: true
  # The number of server agents to run. This determines the fault tolerance of the cluster.
  replicas: 3
# Contains values that configure the Consul UI.
ui:
  enabled: true
  # Registers a Kubernetes Service for the Consul UI as a LoadBalancer.
  service:
    type: LoadBalancer
# Configures and installs the automatic Consul Connect sidecar injector.
connectInject:
  enabled: true
```

</CodeBlockConfig>

For a complete list of Helm chart parameters and configuration, refer to the [Consul Helm chart](/consul/docs/k8s/helm#configuration-values) documentation.

### Deploy Consul datacenter

Deploy a Consul datacenter to your Kubernetes environment with the Consul K8S CLI or Helm.

<Tabs>
<Tab heading="Consul K8S CLI">

Install Consul to your Kubernetes cluster with the Consul K8S CLI. Confirm the run by entering `y`.

```shell-session
$ consul-k8s install -config-file=helm/values-v1.yaml
## ...
    Proceed with installation? (y/N) y
==> Installing Consul
## ...
✓ Consul installed in namespace "consul".
```

Notice that the Consul K8s CLI installs Consul into the `consul` namespace. 

Refer to the [Consul K8S CLI documentation](/consul/docs/k8s/k8s-cli) to learn more about additional settings.

</Tab>
<Tab heading="Helm">

Add the HashiCorp Helm Chart repository.

```shell-session
$ helm repo add hashicorp https://helm.releases.hashicorp.com
"hashicorp" has been added to your repositories
```

Install Consul to your Kubernetes cluster with the Helm chart. Notice that this command installs Consul into the `consul` namespace. 

```shell-session
$ helm install --values helm/values-v1.yaml consul hashicorp/consul --create-namespace --namespace consul --version "1.0.2"
```

</Tab>
</Tabs>

</Tab>
<Tab heading="Local" group="self-local">

### Review Consul server configuration

You will now review the Helm chart for deploying a Consul datacenter in your Kubernetes cluster using the [`consul-k8s` CLI](/consul/docs/k8s/installation/install-cli) or [Helm](/consul/docs/k8s/installation/install) installation methods. 

To deploy Consul on Kubernetes, go directly to [Deploy Consul](#deploy-consul-datacenter-3).

Review `helm/values-v1.yaml`. This file defines the Consul datacenter you will deploy to Kubernetes. Review the comments in the file for an explanation of each parameter.

<CodeBlockConfig filename="helm/values-v1.yaml" hideClipboard>

```yaml
# Contains values that affect multiple components of the chart.
global:
  # The main enabled/disabled setting.
  # If true, servers, clients, Consul DNS and the Consul UI will be enabled.
  enabled: true
  # The prefix used for all resources created in the Helm chart.
  name: consul
  # The consul image version.
  image: hashicorp/consul:1.14.4
  # The name of the datacenter that the agents should register as.
  datacenter: dc1
  # Enables TLS across the cluster to verify authenticity of the Consul servers and clients.
  tls:
    enabled: true
  # Enables ACLs across the cluster to secure access to data and APIs.
  acls:
    # If true, automatically manage ACL tokens and policies for all Consul components.
    manageSystemACLs: true
  # Exposes Prometheus metrics for the Consul service mesh and sidecars.
  metrics:
    enabled: true
    # Enables Consul servers and clients metrics.
    enableAgentMetrics: true
    # Configures the retention time for metrics in Consul servers and clients.
    agentMetricsRetentionTime: "1m"
# Configures values that configure the Consul server cluster.
server:
  enabled: true
  # The number of server agents to run. This determines the fault tolerance of the cluster.
  replicas: 1
# Contains values that configure the Consul UI.
ui:
  enabled: true
  # Defines the type of service created for the Consul UI (e.g. LoadBalancer, ClusterIP, NodePort).
  # NodePort is primarily used for local deployments.
  service:
    type: NodePort
  # Enables displaying metrics in the Consul UI.
  metrics:
    enabled: true
    # The metrics provider specification.
    provider: "prometheus"
    # The URL of the prometheus metrics server.
    baseURL: http://prometheus-server.default.svc.cluster.local
# Configures and installs the automatic Consul Connect sidecar injector.
connectInject:
  enabled: true
    # Enables metrics for Consul Connect sidecars.
  metrics:
    defaultEnabled: true
```

</CodeBlockConfig>

For a complete list of Helm chart parameters and configuration, refer to the [Consul Helm chart](/consul/docs/k8s/helm#configuration-values) documentation.

### Deploy Consul datacenter

Deploy a Consul datacenter to your Kubernetes environment with the Consul K8S CLI or Helm.

<Tabs>
<Tab heading="Consul K8S CLI">

Install Consul to your Kubernetes cluster with the Consul K8S CLI. Confirm the run by entering `y`.

```shell-session
$ consul-k8s install -config-file=helm/values-v1.yaml
## ...
    Proceed with installation? (y/N) y
==> Installing Consul
## ...
✓ Consul installed in namespace "consul".
```

Notice that the Consul K8s CLI installs Consul into the `consul` namespace. 

Refer to the [Consul K8S CLI documentation](/consul/docs/k8s/k8s-cli) to learn more about additional settings.

</Tab>
<Tab heading="Helm">

Add the HashiCorp Helm Chart repository.

```shell-session
$ helm repo add hashicorp https://helm.releases.hashicorp.com
"hashicorp" has been added to your repositories
```

Install Consul to your Kubernetes cluster with the Helm chart. Notice that this command installs Consul into the `consul` namespace. 

```shell-session
$ helm install --values helm/values-v1.yaml consul hashicorp/consul --create-namespace --namespace consul --version "1.0.2"
```

</Tab>
</Tabs>

</Tab>

</Tabs>
</Tab>
</Tabs>

## Configure your CLI to interact with Consul datacenter

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

In this section, you will set environment variables in your terminal so your Consul CLI can interact with your Consul datacenter. The Consul CLI reads these environment variables for behavior defaults and will reference these values when you run `consul` commands.

Tokens are artifacts in the ACL system used to authenticate users, services, and Consul agents. Since ACLs are enabled in this Consul datacenter, entities requesting access to a resource must include a token that is linked with a policy, service identity, or node identity that grants permission to the resource. The ACL system checks the token and grants or denies access to resources based on the associated permissions. A bootstrap token has unrestricted privileges to all resources and APIs.

Set the Consul ACL token as an environment variable.

```shell-session
$ export CONSUL_HTTP_TOKEN=$(terraform output -raw consul_token)
```

Set the Consul destination address. By default, Consul runs on port `8500` for `http` and `8501` for `https`.

```shell-session
$ export CONSUL_HTTP_ADDR=$(terraform output -raw consul_addr)
```

</Tab>
<Tab heading="AKS" group="hcp-aks">

In this section, you will set environment variables in your terminal so your Consul CLI can interact with your Consul datacenter. The Consul CLI reads these environment variables for behavior defaults and will reference these values when you run `consul` commands.

Tokens are artifacts in the ACL system used to authenticate users, services, and Consul agents. Since ACLs are enabled in this Consul datacenter, entities requesting access to a resource must include a token that is linked with a policy, service identity, or node identity that grants permission to the resource. The ACL system checks the token and grants or denies access to resources based on the associated permissions. A bootstrap token has unrestricted privileges to all resources and APIs.

Set the Consul ACL token as an environment variable.

```shell-session
$ export CONSUL_HTTP_TOKEN=$(terraform output -raw consul_root_token)
```

Set the Consul destination address. By default, Consul runs on port `8500` for `http` and `8501` for `https`.

```shell-session
$ export CONSUL_HTTP_ADDR=$(terraform output -raw consul_url)
```


</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

In this section, you will set environment variables in your terminal so your Consul CLI can interact with your Consul datacenter. The Consul CLI reads these environment variables for behavior defaults and will reference these values when you run `consul` commands.

Tokens are artifacts in the ACL system used to authenticate users, services, and Consul agents. Since ACLs are enabled in this Consul datacenter, entities requesting access to a resource must include a token that is linked with a policy, service identity, or node identity that grants permission to the resource. The ACL system checks the token and grants or denies access to resources based on the associated permissions. A bootstrap token has unrestricted privileges to all resources and APIs.

Retrieve the ACL bootstrap token from the respective Kubernetes secret and set it as an environment variable.

```shell-session
$ export CONSUL_HTTP_TOKEN=$(kubectl get --namespace consul secrets/consul-bootstrap-acl-token --template={{.data.token}} | base64 -d)
```

Set the Consul destination address. By default, Consul runs on port `8500` for `http` and `8501` for `https`.

```shell-session
$ export CONSUL_HTTP_ADDR=https://$(kubectl get services/consul-ui --namespace consul -o jsonpath='{.status.loadBalancer.ingress[0].hostname}')
```

Remove SSL verification checks to simplify communication to your Consul datacenter.

```shell-session
$ export CONSUL_HTTP_SSL_VERIFY=false
```

~> **Note:** In a production environment, we recommend keeping this SSL verification set to `true`. Only remove this verification for if you have a Consul datacenter without TLS configured in development environment and demonstration purposes.

</Tab>
<Tab heading="AKS" group="self-aks">

In this section, you will set environment variables in your terminal so your Consul CLI can interact with your Consul datacenter. The Consul CLI reads these environment variables for behavior defaults and will reference these values when you run `consul` commands.

Tokens are artifacts in the ACL system used to authenticate users, services, and Consul agents. Since ACLs are enabled in this Consul datacenter, entities requesting access to a resource must include a token that is linked with a policy, service identity, or node identity that grants permission to the resource. The ACL system checks the token and grants or denies access to resources based on the associated permissions. A bootstrap token has unrestricted privileges to all resources and APIs.

Retrieve the ACL bootstrap token from the respective Kubernetes secret and set it as an environment variable.

```shell-session
$ export CONSUL_HTTP_TOKEN=$(kubectl get --namespace consul secrets/consul-bootstrap-acl-token --template={{.data.token}} | base64 -d)
```

Set the Consul destination address. By default, Consul runs on port `8500` for `http` and `8501` for `https`.

```shell-session
$ export CONSUL_HTTP_ADDR=https://$(kubectl get services/consul-ui --namespace consul -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
```

Remove SSL verification checks to simplify communication to your Consul datacenter.

```shell-session
$ export CONSUL_HTTP_SSL_VERIFY=false
```

~> **Note:** In a production environment, we recommend keeping this SSL verification set to `true`. Only remove this verification for if you have a Consul datacenter without TLS configured in development environment and demonstration purposes.

</Tab>
<Tab heading="Local" group="self-local">

In this section, you will set environment variables in your terminal so your Consul CLI can interact with your Consul datacenter. The Consul CLI reads these environment variables for behavior defaults and will reference these values when you run `consul` commands.

Tokens are artifacts in the ACL system used to authenticate users, services, and Consul agents. Since ACLs are enabled in this Consul datacenter, entities requesting access to a resource must include a token that is linked with a policy, service identity, or node identity that grants permission to the resource. The ACL system checks the token and grants or denies access to resources based on the associated permissions. A bootstrap token has unrestricted privileges to all resources and APIs.

Retrieve the ACL bootstrap token from the respective Kubernetes secret and set it as an environment variable.

```shell-session
$ export CONSUL_HTTP_TOKEN=$(kubectl get --namespace consul secrets/consul-bootstrap-acl-token --template={{.data.token}} | base64 -d)
```

Set the Consul destination address. By default, Consul runs on port `8500` for `http` and `8501` for `https`.

```shell-session
$ export CONSUL_HTTP_ADDR=https://127.0.0.1:8501
```

Remove SSL verification checks to simplify communication to your Consul datacenter.

```shell-session
$ export CONSUL_HTTP_SSL_VERIFY=false
```

~> **Note:** In a production environment, we recommend keeping this SSL verification set to `true`. Only remove this verification for if you have a Consul datacenter without TLS configured in development environment and demonstration purposes.

</Tab>

</Tabs>
</Tab>
</Tabs>

## View Consul services

<Tabs>
<Tab heading="HCP-managed Consul" group="hcp">
<Tabs>
<Tab heading="EKS" group="hcp-eks">

In this section, you will view your Consul services with the CLI, UI, and/or API to explore the details of your service mesh.

<Tabs>
<Tab heading="CLI">

In your terminal, run the CLI command `consul catalog services` to return the list of services registered in Consul. Notice this returns only the `consul` service since it is the only running service in your Consul datacenter.

```shell-session
$ consul catalog services
consul
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

Run the CLI command `consul members` to return the list of Consul agents in your environment. 

```shell-session
$ consul members
Node             Address            Status  Type    Build       Protocol  DC               Partition  Segment
ip-172-25-32-114 172.25.32.114:8301 alive   server  1.14.4+ent  2         learn-consul-gs  default    <all>
```

</Tab>
<Tab heading="UI">

Output the HCP Consul URL value to your terminal and paste it in your browser.

```shell-session
$ echo $CONSUL_HTTP_ADDR
learn-hcp-eks-cluster.public.consul.00000000-0000-0000-0000-000000000000.aws.hashicorp.cloud
```

Output the token value to your terminal and copy the value to your clipboard. You will use this ACL token to authenticate in the Consul UI.

```shell-session
$ echo $CONSUL_HTTP_TOKEN
fe0dd5c3-f2e1-81e8-cde8-49d26cee5efc
```

On the left navigation pane, click **Services** to review your deployed services. At this time, you will only find the `consul` service.

![Consul UI Services Page](/img/consul/kubernetes-gs-deploy_consul_ui_services_hcp.png 'Consul services page in UI with Consul services')

By default, the anonymous ACL policy allows you to view the contents of Consul services, nodes, and intentions. To make changes and see more details within the Consul UI, click **Log In** in the top right and insert your ACL token.

![Consul UI Login Page](/img/consul/kubernetes-gs-deploy_consul_ui_login.png 'Consul login page in UI')

After successfully authenticating with your ACL token, you are now able to view additional Consul components and make changes in the UI. Notice you can view and manage more options under the **Access Controls** section on the left navigation pane.

![Consul UI Post Authentication](/img/consul/kubernetes-gs-deploy_consul_ui_post_authentication.png 'Consul UI post authentication')

On the left navigation pane, click on **Nodes**. 

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.
 
![Consul UI View Nodes](/img/consul/kubernetes-gs-deploy_consul_view_nodes_hcp.png 'Consul UI view nodes')

</Tab>
<Tab heading="API">

In your terminal, view the list of services registered in Consul.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/catalog/services\?pretty
```

Sample output: 

```json hideClipboard
{
    "consul": []
}
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

View the list of server and client Consul agents in your environment.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/agent/members\?pretty
```

Sample output:

```json hideClipboard
[
    {
        "Name": "912fdb64-f013-535c-b564-c4351ecdb96a",
        "Addr": "172.25.16.4",
        "Port": 8301,
        "Tags": {
            "acls": "1",
            "bootstrap": "1",
            "build": "1.14.4+ent:e5a8325f",
            "dc": "learn-consul-gs",
            "ft_admpart": "1",
            "ft_fs": "1",
            "ft_ns": "1",
            "ft_si": "1",
            "grpc_tls_port": "8502",
            "id": "af11b884-3999-9214-7366-331bd1712fed",
            "port": "8300",
            "raft_vsn": "3",
            "role": "consul",
            "segment": "",
            "use_tls": "1",
            "vsn": "2",
            "vsn_max": "3",
            "vsn_min": "2",
            "wan_join_port": "8302"
        },
        "Status": 1,
        "ProtocolMin": 1,
        "ProtocolMax": 5,
        "ProtocolCur": 2,
        "DelegateMin": 2,
        "DelegateMax": 5,
        "DelegateCur": 4
    }
]
```

</Tab>
</Tabs>

All services listed in your Consul catalog are empowered with Consul's service discovery capabilities that simplify scalability challenges and improve application resiliency. Review the [Service Discovery overview](/consul/docs/concepts/service-discovery) page to learn more.

</Tab>
<Tab heading="AKS" group="hcp-aks">

In this section, you will view your Consul services with the CLI, UI, and/or API to explore the details of your service mesh.

<Tabs>
<Tab heading="CLI">

In your terminal, run the CLI command `consul catalog services` to return the list of services registered in Consul. Notice this returns only the `consul` service since it is the only running service in your Consul datacenter.

```shell-session
$ consul catalog services
consul
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

Run the CLI command `consul members` to return the list of Consul agents in your environment. 

```shell-session
$ consul members
Node             Address           Status  Type    Build       Protocol  DC               Partition  Segment
912fdb64-f01...  172.25.16.4:8301  alive   server  1.14.4+ent  2         learn-consul-gs  default    <all>
```

</Tab>
<Tab heading="UI">

Output the HCP Consul URL value to your terminal and paste it in your browser.

```shell-session
$ echo $CONSUL_HTTP_ADDR
https://servers-public-consul-8d4f721f.db0ea9b8.z1.hashicorp.cloud
```

Output the token value to your terminal and copy the value to your clipboard. You will use this ACL token to authenticate in the Consul UI.

```shell-session
$ echo $CONSUL_HTTP_TOKEN
fe0dd5c3-f2e1-81e8-cde8-49d26cee5efc
```

On the left navigation pane, click **Services** to review your deployed services. At this time, you will only find the `consul` service.

![Consul UI Services Page](/img/consul/kubernetes-gs-deploy_consul_ui_services_hcp.png 'Consul services page in UI with Consul services')

By default, the anonymous ACL policy allows you to view the contents of Consul services, nodes, and intentions. To make changes and see more details within the Consul UI, click **Log In** in the top right and insert your ACL token.

![Consul UI Login Page](/img/consul/kubernetes-gs-deploy_consul_ui_login.png 'Consul login page in UI')

After successfully authenticating with your ACL token, you are now able to view additional Consul components and make changes in the UI. Notice you can view and manage more options under the **Access Controls** section on the left navigation pane.

![Consul UI Post Authentication](/img/consul/kubernetes-gs-deploy_consul_ui_post_authentication.png 'Consul UI post authentication')

On the left navigation pane, click on **Nodes**. 

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.
 
![Consul UI View Nodes](/img/consul/kubernetes-gs-deploy_consul_view_nodes_hcp.png 'Consul UI view nodes')

</Tab>
<Tab heading="API">

In your terminal, view the list of services registered in Consul.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/catalog/services\?pretty
```

Sample output: 

```json hideClipboard
{
    "consul": []
}
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

View the list of server and client Consul agents in your environment.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/agent/members\?pretty
```

Sample output:

```json hideClipboard
[
    {
        "Name": "912fdb64-f013-535c-b564-c4351ecdb96a",
        "Addr": "172.25.16.4",
        "Port": 8301,
        "Tags": {
            "acls": "1",
            "bootstrap": "1",
            "build": "1.14.4+ent:e5a8325f",
            "dc": "learn-consul-gs",
            "ft_admpart": "1",
            "ft_fs": "1",
            "ft_ns": "1",
            "ft_si": "1",
            "grpc_tls_port": "8502",
            "id": "af11b884-3999-9214-7366-331bd1712fed",
            "port": "8300",
            "raft_vsn": "3",
            "role": "consul",
            "segment": "",
            "use_tls": "1",
            "vsn": "2",
            "vsn_max": "3",
            "vsn_min": "2",
            "wan_join_port": "8302"
        },
        "Status": 1,
        "ProtocolMin": 1,
        "ProtocolMax": 5,
        "ProtocolCur": 2,
        "DelegateMin": 2,
        "DelegateMax": 5,
        "DelegateCur": 4
    }
]
```

</Tab>
</Tabs>

All services listed in your Consul catalog are empowered with Consul's service discovery capabilities that simplify scalability challenges and improve application resiliency. Review the [Service Discovery overview](/consul/docs/concepts/service-discovery) page to learn more.

</Tab>
</Tabs>
</Tab>

<Tab heading="Self-managed Consul" group="self">
<Tabs>
<Tab heading="EKS" group="self-eks">

In this section, you will view your Consul services with the CLI, UI, and/or API to explore the details of your service mesh.

<Tabs>
<Tab heading="CLI">

In your terminal, run the CLI command `consul catalog services` to return the list of services registered in Consul. Notice this returns only the `consul` service since it is the only running service in your Consul datacenter.

```shell-session
$ consul catalog services
consul
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

Run the CLI command `consul members` to return the list of Consul agents in your environment. 

```shell-session
$ consul members
Node             Address           Status  Type    Build   Protocol  DC   Partition  Segment
consul-server-0  10.0.4.13:8301    alive   server  1.14.4  2         dc1  default    <all>
consul-server-1  10.0.6.43:8301    alive   server  1.14.4  2         dc1  default    <all>
consul-server-2  10.0.5.64:8301    alive   server  1.14.4  2         dc1  default    <all>
```

</Tab>
<Tab heading="UI">

Output the HCP Consul URL value to your terminal and paste it in your browser to find the Consul UI. Since this environment uses a self-signed TLS certificate for its resources, click to proceed through the certificate warnings.

```shell-session
$ echo $CONSUL_HTTP_ADDR
https://a55925452f7214a1cad0a0d564ae1872-646141274.us-west-2.elb.amazonaws.com
```

Output the token value to your terminal and copy the value to your clipboard. You will use this ACL token to authenticate in the Consul UI.

```shell-session
$ echo $CONSUL_HTTP_TOKEN
fe0dd5c3-f2e1-81e8-cde8-49d26cee5efc
```

On the left navigation pane, click **Services** to review your deployed services. At this time, you will only find the `consul` service.

![Consul UI Services Page](/img/consul/kubernetes-gs-deploy_consul_ui_services.png 'Consul services page in UI with Consul services')

By default, the anonymous ACL policy allows you to view the contents of Consul services, nodes, and intentions. To make changes and see more details within the Consul UI, click **Log In** in the top right and insert your bootstrap ACL token.

![Consul UI Login Page](/img/consul/kubernetes-gs-deploy_consul_ui_login.png 'Consul login page in UI')

After successfully authenticating with your ACL token, you are now able to view additional Consul components and make changes in the UI. Notice you can view and manage more options under the **Access Controls** section on the left navigation pane.

![Consul UI Post Authentication](/img/consul/kubernetes-gs-deploy_consul_ui_post_authentication.png 'Consul UI post authentication')

On the left navigation pane, click on **Nodes**. 

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.
 
![Consul UI View Nodes](/img/consul/kubernetes-gs-deploy_consul_view_nodes.png 'Consul UI view nodes')

</Tab>
<Tab heading="API">

In your terminal, view the list of services registered in Consul.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/catalog/services
```

Sample output: 

```json hideClipboard
{"consul":[]}
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

View the list of server and client Consul agents in your environment.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/agent/members
```

Sample output:

```json hideClipboard
[{"Name":"consul-server-0","Addr":"10.244.0.24","Port":8301,"Tags":{"acls":"1","bootstrap":"1","build":"1.14.4:c6d0f9ec","dc":"dc1","ft_fs":"1","ft_si":"1","grpc_port":"8503","id":"9da2304b-3829-4af8-7256-bc240d57d42b","port":"8300","raft_vsn":"3","role":"consul","segment":"","use_tls":"1","vsn":"2","vsn_max":"3","vsn_min":"2","wan_join_port":"8302"},"Status":1,"ProtocolMin":1,"ProtocolMax":5,"ProtocolCur":2,"DelegateMin":2,"DelegateMax":5,"DelegateCur":4}]
```

</Tab>
</Tabs>

All services listed in your Consul catalog are empowered with Consul's service discovery capabilities that simplify scalability challenges and improve application resiliency. Review the [Service Discovery overview](/consul/docs/concepts/service-discovery) page to learn more.

</Tab>
<Tab heading="AKS" group="self-aks">

In this section, you will view your Consul services with the CLI, UI, and/or API to explore the details of your service mesh.

<Tabs>
<Tab heading="CLI">

In your terminal, run the CLI command `consul catalog services` to return the list of services registered in Consul. Notice this returns only the `consul` service since it is the only running service in your Consul datacenter.

```shell-session
$ consul catalog services
consul
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

Run the CLI command `consul members` to return the list of Consul agents in your environment. 

```shell-session
$ consul members
Node             Address           Status  Type    Build   Protocol  DC   Partition  Segment
consul-server-0  10.0.4.13:8301    alive   server  1.14.4  2         dc1  default    <all>
consul-server-1  10.0.6.43:8301    alive   server  1.14.4  2         dc1  default    <all>
consul-server-2  10.0.5.64:8301    alive   server  1.14.4  2         dc1  default    <all>
```

</Tab>
<Tab heading="UI">

Output the HCP Consul URL value to your terminal and paste it in your browser to find the Consul UI. Since this environment uses a self-signed TLS certificate for its resources, click to proceed through the certificate warnings.

```shell-session
$ echo $CONSUL_HTTP_ADDR
https://a55925452f7214a1cad0a0d564ae1872-646141274.us-west.azure.com
```

<Note>

 In a production environment, we recommend keeping this SSL verification set to `true`. Only remove this verification for if you have a Consul cluster without TLS configured in development environment and demonstration purposes.

</Note>

Output the token value to your terminal and copy the value to your clipboard. You will use this ACL token to authenticate in the Consul UI.

```shell-session
$ echo $CONSUL_HTTP_TOKEN
fe0dd5c3-f2e1-81e8-cde8-49d26cee5efc
```

On the left navigation pane, click **Services** to review your deployed services. At this time, you will only find the `consul` service.

![Consul UI Services Page](/img/consul/kubernetes-gs-deploy_consul_ui_services.png 'Consul services page in UI with Consul services')

By default, the anonymous ACL policy allows you to view the contents of Consul services, nodes, and intentions. To make changes and see more details within the Consul UI, click **Log In** in the top right and insert your bootstrap ACL token.

![Consul UI Login Page](/img/consul/kubernetes-gs-deploy_consul_ui_login.png 'Consul login page in UI')

After successfully authenticating with your ACL token, you are now able to view additional Consul components and make changes in the UI. Notice you can view and manage more options under the **Access Controls** section on the left navigation pane.

![Consul UI Post Authentication](/img/consul/kubernetes-gs-deploy_consul_ui_post_authentication.png 'Consul UI post authentication')

On the left navigation pane, click on **Nodes**. 

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.
 
![Consul UI View Nodes](/img/consul/kubernetes-gs-deploy_consul_view_nodes.png 'Consul UI view nodes')

</Tab>
<Tab heading="API">

In your terminal, view the list of services registered in Consul.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/catalog/services
```

Sample output: 

```json hideClipboard
{"consul":[]}
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

View the list of server and client Consul agents in your environment.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/agent/members
```

Sample output:

```json hideClipboard
[{"Name":"consul-server-0","Addr":"10.244.0.24","Port":8301,"Tags":{"acls":"1","bootstrap":"1","build":"1.14.4:c6d0f9ec","dc":"dc1","ft_fs":"1","ft_si":"1","grpc_port":"8503","id":"9da2304b-3829-4af8-7256-bc240d57d42b","port":"8300","raft_vsn":"3","role":"consul","segment":"","use_tls":"1","vsn":"2","vsn_max":"3","vsn_min":"2","wan_join_port":"8302"},"Status":1,"ProtocolMin":1,"ProtocolMax":5,"ProtocolCur":2,"DelegateMin":2,"DelegateMax":5,"DelegateCur":4}]
```

</Tab>
</Tabs>

All services listed in your Consul catalog are empowered with Consul's service discovery capabilities that simplify scalability challenges and improve application resiliency. Review the [Service Discovery overview](/consul/docs/concepts/service-discovery) page to learn more.

</Tab>
<Tab heading="Local" group="self-local">

In this section, you will view your Consul services with the CLI, UI, and/or API to explore the details of your service mesh.

<Tabs>
<Tab heading="CLI">

Open a separate terminal window and expose the Consul server with `kubectl port-forward` using the `consul-ui` service name as the target. 

```shell-session
$ kubectl port-forward svc/consul-ui --namespace consul 8501:443
```

In your original terminal, run the CLI command `consul catalog services` to return the list of services registered in Consul. Notice this returns only the `consul` service since it is the only running service in your Consul datacenter.

```shell-session
$ consul catalog services
consul
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

Run the CLI command `consul members` to return the list of Consul agents in your environment. 

```shell-session
$ consul members
Node             Address           Status  Type    Build   Protocol  DC   Partition  Segment
consul-server-0  10.0.4.13:8301    alive   server  1.14.4  2         dc1  default    <all>
```

</Tab>
<Tab heading="UI">

Output the token value to your terminal and copy the value to your clipboard. You will use this ACL token to authenticate in the Consul UI.

```shell-session
$ echo $CONSUL_HTTP_TOKEN
fe0dd5c3-f2e1-81e8-cde8-49d26cee5efc
```

Open a separate terminal window and expose the Consul UI with `kubectl port-forward` using the `consul-ui` service name as the target. 

```shell-session
$ kubectl port-forward svc/consul-ui --namespace consul 8501:443
```

Open [https://localhost:8501](https://localhost:8501) in your browser to find the Consul UI. Since this environment uses a self-signed TLS certificate for its resources, click to proceed through the certificate warnings.

On the left navigation pane, click **Services** to review your deployed services. At this time, you will only find the `consul` service.

![Consul UI Services Page](/img/consul/kubernetes-gs-deploy_consul_ui_services.png 'Consul services page in UI with Consul services')

By default, the anonymous ACL policy allows you to view the contents of Consul services, nodes, and intentions. To make changes and see more details within the Consul UI, click **Log In** in the top right and insert your bootstrap ACL token.

![Consul UI Login Page](/img/consul/kubernetes-gs-deploy_consul_ui_login.png 'Consul login page in UI')

After successfully authenticating with your ACL token, you are now able to view additional Consul components and make changes in the UI. Notice you can view and manage more options under the **Access Controls** section on the left navigation pane.

![Consul UI Post Authentication](/img/consul/kubernetes-gs-deploy_consul_ui_post_authentication.png 'Consul UI post authentication')

On the left navigation pane, click on **Nodes**. 

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.
 
![Consul UI View Nodes](/img/consul/kubernetes-gs-deploy_consul_view_nodes.png 'Consul UI view nodes')

</Tab>
<Tab heading="API">

Open a separate terminal window and expose the Consul server with `kubectl port-forward` using the `consul-ui` service name as the target. 

```shell-session
$ kubectl port-forward svc/consul-ui --namespace consul 8501:443
```

In your original terminal, view the list of services registered in Consul.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/catalog/services
```

Sample output: 

```json hideClipboard
{"consul":[]}
```

Agents run in either server or client mode. Server agents store all state information, including service and node IP addresses, health checks, and configuration. Client agents are lightweight processes that make up the majority of the datacenter. They report service health status to the server agents. Clients must run on every pod where services are running.

View the list of server and client Consul agents in your environment.

```shell-session
$ curl -k \
    --header "X-Consul-Token: $CONSUL_HTTP_TOKEN" \
    $CONSUL_HTTP_ADDR/v1/agent/members
```

Sample output:

```json hideClipboard
[{"Name":"consul-server-0","Addr":"10.244.0.24","Port":8301,"Tags":{"acls":"1","bootstrap":"1","build":"1.14.4:c6d0f9ec","dc":"dc1","ft_fs":"1","ft_si":"1","grpc_port":"8503","id":"9da2304b-3829-4af8-7256-bc240d57d42b","port":"8300","raft_vsn":"3","role":"consul","segment":"","use_tls":"1","vsn":"2","vsn_max":"3","vsn_min":"2","wan_join_port":"8302"},"Status":1,"ProtocolMin":1,"ProtocolMax":5,"ProtocolCur":2,"DelegateMin":2,"DelegateMax":5,"DelegateCur":4}]
```

</Tab>
</Tabs>

All services listed in your Consul catalog are empowered with Consul's service discovery capabilities that simplify scalability challenges and improve application resiliency. Review the [Service Discovery overview](/consul/docs/concepts/service-discovery) page to learn more.

</Tab>

</Tabs>
</Tab>
</Tabs>

## Next Steps

In this tutorial, you integrated Consul into your Kubernetes environment. After deploying Consul, you interacted with Consul using the CLI, UI, and API.

In the [next tutorial](/consul/tutorials/get-started-kubernetes/kubernetes-gs-service-mesh), you will deploy HashiCups, a demo application, onto your Kubernetes cluster to explore how to use Consul service mesh for service-to-service traffic management.

For more information about the topics covered in this tutorial, refer to the following resources:

- [Consul Docs](/consul/docs)
- [Consul Kubernetes Docs](/consul/docs/k8s)
- [Consul Kubernetes Deployment Guide](/consul/tutorials/kubernetes/kubernetes-deployment-guide)
